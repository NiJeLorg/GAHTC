{% extends 'website/base.html' %} 
{% load staticfiles %} 
{% block title %}Modules{% endblock %} 

{% block css_block %} 
{% endblock %} 

{% block head_js_block %} 
{% endblock %} 

{% block content %}
<!-- Page Content -->
<div class="container">
    <div class="row">
        <div class="col-md-12">
            <h1>Modules</h1>
        </div>
    </div>
    <div class="row marginBottom15">
        <div class="panel-group" id="accordion_modules" role="tablist" aria-multiselectable="true">
            {% for module_returned in modules_returned %}
            <div class="panel panel-default">
                <div class="panel-heading" role="tab" id="heading_{{ module_returned.id }}">
                    <a class="noTextDecoration" role="button" data-toggle="collapse" data-parent="#accordion_modules" href="#{{ module_returned.id }}" aria-expanded="true" aria-controls="{{ module_returned.id }}">
                        <h4 class="panel-title">
								<span class="label label-primary">{{ module_returned.title }}</span>
							</h4>
						</a>
					</div>
					<div id="{{ module_returned.id }}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="{{ module_returned.id }}">
						<div class="panel-body">
							<div class="row">
								<div class="col-md-9">
									<p><strong>Authors:</strong> 
									{% for authors in module_returned.authors_m2m.all %}
										<a href="/members/#{{ authors.id }}">{{ authors.first_name }} {{ authors.last_name }}</a>{% if not forloop.last %}, {% endif %}
									{% endfor %}
									<br />
									<strong>Description: </strong> {{ module_returned.description }}</p>
								</div>
								<div class="col-md-3">
								{% if user.is_authenticated %}
					                {% if request.user.userProfile.verified %}
					                	<button type="button" class="btn btn-default downloadModule pull-right" data-moduleid="{{ module_returned.id }}">Download module</button>
					                {% else %}
					                	<button type="button" class="btn btn-default pull-right" data-toggle="modal" data-target="#waitingForVerification">Download module</button>
					                {% endif %}
								{% endif %}
								</div>		
							</div>
							<div class="row">
								<div class="col-md-12">
									{% if module_returned.moduleDocs|length > 0 %}
										<h5><span class="label label-primary">Documents for this module</span></h5>
										<ul>				
										{% for doc in module_returned.moduleDocs %}
											<li>{{ doc.title }}</li>
										{% endfor %}
										</ul>
									{% endif %}
								</div>
							</div>
							<div class="row">
								<div class="col-md-12">
									{% if module_returned.moduleLecs|length > 0 %}
										<h5><span class="label label-success">Lectures</span></h5>
										{% for lec in module_returned.moduleLecs %}
											<h4>{{ lec.title }}</h4>
												{% if user.is_authenticated %}
													<button type="button" class="btn btn-default btn-xs launchModal" data-lectureid="{{ lec.id }}">Preview lecture</button>
													{% if request.user.userProfile.verified %}
					                					<button type="button" class="btn btn-default btn-xs downloadLecture" data-lectureid="{{ lec.id }}">Download this lecture &amp; documents</button>
					                				{% else %}
					                					<button type="button" class="btn btn-default btn-xs " data-toggle="modal" data-target="#waitingForVerification">Download this lecture &amp; documents</button>
					                				{% endif %}
												{% endif %}
												{% if lec.lectureDocs|length > 0 %}
													<h5><span class="label label-info">Documents for this lecture</span></h5>
													<ul>
													{% for lecDoc in lec.lectureDocs %}
														<li>{{ lecDoc.title }}</li>
													{% endfor %}
													</ul>
												{% endif %}
											{% if not forloop.last %}
												<hr />
											{% endif %}
										{% endfor %}
									{% endif %}
								</div>
							</div>							
						</div>
					</div>

				</div>

			{% endfor %}
            {% for module_returned in coming_soon_modules_returned %}
            <div class="panel panel-default">
                <div class="panel-heading" role="tab" id="heading_{{ module_returned.id }}">
                    <a class="noTextDecoration" role="button" data-toggle="collapse" data-parent="#accordion_modules" href="#cs_{{ module_returned.id }}" aria-expanded="true" aria-controls="cs_{{ module_returned.id }}">
                        <h4 class="panel-title">
								<span class="label label-cs">Coming Soon: {{ module_returned.title }}</span>
							</h4>
						</a>
					</div>
					<div id="cs_{{ module_returned.id }}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="cs_{{ module_returned.id }}">
						<div class="panel-body">
							<div class="row">
								<div class="col-md-9">
									<p><strong>Authors:</strong> 
									{% for authors in module_returned.authors_m2m.all %}
										<a href="/members/#{{ authors.id }}">{{ authors.first_name }} {{ authors.last_name }}</a>{% if not forloop.last %}, {% endif %}
									{% endfor %}
									<br />
									<strong>Description: </strong> {{ module_returned.description }}</p>
								</div>	
							</div>
						</div>
					</div>

				</div>

			{% endfor %}

		</div>
	</div>

</div>				
{% endblock %}

{% block modal_block %}
<!-- Download Course Bundle Modal -->
<div class="modal fade" id="downloadModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Download Course Materials</h4>
            </div>
            <div class="modal-body">
                <div id="downloadFileArea">
                    <div class="containter">
                        <div class="row">
                            <div class="col-md-3">
                                <img class="img-responsive pull-right" src="{% static 'website/css/images/spiffygif_114x114.gif' %}" />
                            </div>
                            <div class="col-md-9">
                                <h2>Zipping Up Your Materials!</h2>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Awaiting verification modal -->
<div class="modal fade" id="waitingForVerification" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Your account is awaiting verification.</h4>
            </div>
            <div class="modal-body">
                <p>Your account has not yet been verified by a GAHTC administrator. Once your account is verified, you will be able to download course materials. You will be notified by email when your account has been verified. In the meantime, you can continue to search the site and add resources to your bundles. Thank you!</p>
            </div>
        </div>
    </div>
</div>
<!-- Lecture Slides Modal -->
<div class="modal fade" id="slideshow" tabindex="-1" role="dialog" aria-labelledby="mySlideshow">
</div>
{% endblock %} 

{% block js_block %}
<script type="text/javascript">
var tab = "none";
</script>
<script type="text/javascript" src="{% static 'website/js/jquery.scrollTo.min.js' %}"></script>
<script type="text/javascript" src="{% static 'website/js/gahtcApplication.js' %}"></script>
<script type="text/javascript" src="{% static 'website/js/application.js' %}"></script>
<script type="text/javascript" src="{% static 'website/js/controllers.js' %}"></script>
{% endblock %}

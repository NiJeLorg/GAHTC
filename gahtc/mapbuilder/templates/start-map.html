{% extends 'website/base.html' %} 
{% load staticfiles %} 

{% block head_js_block %}
<script src="https://maps.googleapis.com/maps/api/js?key={{ GOOGLE_MAPS_API }}" async defer></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
 integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
 crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
 integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
 crossorigin=""></script>
 <script type="text/javascript" src="https://unpkg.com/leaflet-geosearch@2.6.0/dist/bundle.min.js"></script>
 <script src='https://unpkg.com/leaflet.gridlayer.googlemutant@latest/Leaflet.GoogleMutant.js'></script>
 <link  href="https://unpkg.com/leaflet-geosearch@latest/assets/css/leaflet.css" rel="stylesheet" />
{% endblock %}

{% block css_block %}
<link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}" >
{% endblock%}
  
{% block content%}
  <div class="map-header">
    <h3 class="map-header-text"><strong>Step 1: </strong>Refine Your Location Search</h3>
    <a class="create-button step-button">Next</a>
  </div>
  <div id="map"></div>
    <div class="layer-switcher">
      <button class="layer-buttons" id="btn1">Terrain</button>
      <button class="layer-buttons button-active" id="btn2">Political</button>
      <button class="layer-buttons" id="btn3">Satellite</button>
    </div>
  <script>
  // initialize the map
  var map = L.map('map').setView([51.505, -0.09], 13);
  
  var roads = L.gridLayer.googleMutant({
        type: 'roadmap', // valid values are 'roadmap', 'satellite', 'terrain' and 'hybrid'
      }).addTo(map);


// Add GeorSearch 
var z = window.GeoSearch;

const provider = new z.GoogleProvider();

const searchControl = new z.GeoSearchControl({
provider:provider,
style: 'button',
key:'{{ GOOGLE_MAPS_API }}',
autoClose: true,
showMarker: true,
marker: {                                           // optional: L.Marker    - default L.Icon.Default
    icon: new L.Icon.Default(),
    draggable: false,
  },
});

map.addControl(searchControl)

window.onload = function() {
  var searchBox = document.getElementsByClassName('glass');
  searchBox.value = localStorage.getItem('searchValue');
  console.log(searchBox);

}

// Toggle Between layers
$('.layer-buttons').click(function(e) {       
    $('.layer-buttons').removeClass('button-active');    
    $(this).addClass('button-active');
    if (this.id == 'btn1') {
      $(this).addClass('button-active');
      var roads = L.gridLayer.googleMutant({
        type: 'terrain'
      }).addTo(map);
    } else if (this.id == 'btn2'){
      var roads = L.gridLayer.googleMutant({
        type: 'roadmap'
      }).addTo(map);
    } else {
      var roads = L.gridLayer.googleMutant({
        type: 'satellite'
      }).addTo(map);
    }
});

  </script>
{% endblock%}
	
